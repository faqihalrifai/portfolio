<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library of Insights | Muhammad Faqih Al Rifai</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif'],
                    },
                    colors: {
                        gold: '#c5a028',
                        goldHover: '#a3841f',
                        darkBg: '#121212',        
                        darkCard: '#1e1e1e',       
                    },
                }
            }
        }
    </script>

    <style>
        body { background-color: #ffffff; color: #111827; font-family: 'Plus Jakarta Sans', sans-serif; overflow-x: hidden; }
        .dark body { background-color: #121212; color: #f3f4f6; }
        
        .glass-nav { 
            background: rgba(255, 255, 255, 0.8); 
            backdrop-filter: blur(12px); 
            border-bottom: 1px solid rgba(0,0,0,0.05); 
        }
        .dark .glass-nav { 
            background: rgba(18, 18, 18, 0.8); 
            border-bottom: 1px solid rgba(255,255,255,0.05); 
        }

        .mini-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .mini-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -10px rgba(197, 160, 40, 0.15);
        }

        /* Custom Scrollbar for mini cards area */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #374151; }
    </style>
</head>
<body class="transition-colors duration-300">

    <!-- Navigasi -->
    <nav class="sticky top-0 z-50 glass-nav py-4">
        <div class="max-w-6xl mx-auto px-6 flex justify-between items-center">
            <a href="index.html" class="group flex items-center gap-2 text-[10px] font-bold uppercase tracking-[0.2em] text-gray-500 dark:text-gray-400 hover:text-gold transition-colors">
                <i class="fas fa-arrow-left transition-transform group-hover:-translate-x-1"></i> 
                <span data-i18n="navBack">Kembali</span>
            </a>
            <div class="flex items-center gap-4">
                <button id="langToggle" class="w-8 h-8 rounded-full border border-black/5 dark:border-white/10 flex items-center justify-center text-[10px] font-bold dark:text-white">ID</button>
                <button id="themeToggle" class="w-8 h-8 rounded-full border border-black/5 dark:border-white/10 flex items-center justify-center text-gray-500 dark:text-gray-400">
                    <i class="fas fa-moon dark:hidden"></i><i class="fas fa-sun hidden dark:block text-gold"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Header Sederhana -->
    <header class="py-16 bg-gray-50/50 dark:bg-darkCard/20">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <h1 class="text-3xl md:text-5xl font-serif font-bold dark:text-white mb-6" data-i18n="mainTitle">Library of <span class="text-gold italic font-medium">Insights</span></h1>
            
            <!-- Pencarian Interaktif -->
            <div class="relative max-w-xl mx-auto group">
                <input type="text" id="searchInput" onkeyup="liveSearch()" placeholder="Cari strategi atau wawasan..." data-i18n-placeholder="searchPlaceholder" class="w-full pl-12 pr-6 py-4 rounded-2xl border border-gray-200 dark:border-white/10 bg-white dark:bg-darkCard text-sm focus:ring-2 focus:ring-gold/20 focus:border-gold outline-none transition-all shadow-sm group-hover:shadow-md">
                <i class="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-gold transition-colors text-sm"></i>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-6 py-16">
        <!-- Status Pencarian -->
        <div id="searchStatus" class="mb-8 text-[10px] font-bold uppercase tracking-widest text-gray-400 hidden">
            <span data-i18n="resultsFound">Ditemukan</span>: <span id="countResults" class="text-gold">0</span>
        </div>

        <!-- GRID ARTIKEL MINI -->
        <div id="blogGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Loading Placeholder -->
            <div class="col-span-full py-20 text-center">
                <div class="inline-block w-6 h-6 border-2 border-gold border-t-transparent rounded-full animate-spin mb-4"></div>
                <p class="text-gray-400 text-xs italic" data-i18n="loadingText">Menyelaraskan data...</p>
            </div>
        </div>

        <!-- Empty State -->
        <div id="noResults" class="hidden py-24 text-center">
            <div class="w-16 h-16 bg-gray-100 dark:bg-darkCard rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300">
                <i class="fas fa-search text-xl"></i>
            </div>
            <p class="text-gray-500 text-sm" data-i18n="noMatch">Maaf, wawasan tersebut belum tersedia.</p>
        </div>
    </main>

    <!-- SCRIPT -->
    <script>
        let allPosts = [];
        let currentLang = localStorage.getItem('lang') || 'id';

        const translations = {
            id: {
                navBack: "Kembali",
                mainTitle: "Library of Insights",
                searchPlaceholder: "Cari strategi atau wawasan...",
                loadingText: "Menyelaraskan data...",
                noMatch: "Maaf, wawasan tersebut belum tersedia.",
                readMore: "Baca Selengkapnya",
                resultsFound: "Hasil Ditemukan"
            },
            en: {
                navBack: "Back",
                mainTitle: "Library of Insights",
                searchPlaceholder: "Search strategies or insights...",
                loadingText: "Syncing data...",
                noMatch: "Sorry, that insight is not available yet.",
                readMore: "Read More",
                resultsFound: "Results Found"
            }
        };

        // 1. Fetch Data dari WP (Anti-Cache)
        async function fetchAllPosts() {
            // Ditambahkan timestamp agar data benar-benar real-time setiap refresh
            const apiURL = `https://dev-faqihalrf.pantheonsite.io/wp-json/wp/v2/posts?_embed&per_page=40&t=${new Date().getTime()}`;
            const grid = document.getElementById('blogGrid');

            try {
                const response = await fetch(apiURL);
                allPosts = await response.json();
                
                if (allPosts.length === 0) {
                    grid.innerHTML = '<p class="col-span-full text-center text-gray-500 text-xs italic">Belum ada konten yang diterbitkan.</p>';
                    return;
                }

                renderPosts(allPosts);
            } catch (error) {
                grid.innerHTML = '<p class="text-red-500 text-center col-span-full text-xs italic">Gagal terhubung ke server konten. Periksa koneksi Anda.</p>';
            }
        }

        // 2. Render Kartu Mini
        function renderPosts(posts) {
            const grid = document.getElementById('blogGrid');
            
            grid.innerHTML = posts.map(post => {
                const img = post._embedded['wp:featuredmedia'] ? post._embedded['wp:featuredmedia'][0].source_url : 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=500';
                const date = new Date(post.date).toLocaleDateString(currentLang === 'id' ? 'id-ID' : 'en-US', { day: 'numeric', month: 'short', year: 'numeric' });
                
                // Ambil kategori dengan aman
                let cat = 'Digital Marketing';
                if (post._embedded['wp:term'] && post._embedded['wp:term'][0] && post._embedded['wp:term'][0][0]) {
                    cat = post._embedded['wp:term'][0][0].name;
                }
                
                return `
                    <article class="mini-card flex flex-col bg-white dark:bg-darkCard rounded-2xl overflow-hidden border border-gray-100 dark:border-white/5 shadow-sm">
                        <div class="h-40 overflow-hidden relative">
                            <img src="${img}" class="w-full h-full object-cover">
                            <div class="absolute top-3 left-3 bg-black/40 backdrop-blur-md text-white text-[9px] font-bold px-2 py-0.5 rounded-md uppercase tracking-widest">${cat}</div>
                        </div>
                        <div class="p-5 flex flex-col flex-1">
                            <span class="text-[9px] text-gray-400 font-bold uppercase mb-2">${date}</span>
                            <h2 class="font-bold text-sm dark:text-white mb-3 line-clamp-2 leading-snug">${post.title.rendered}</h2>
                            <a href="${post.link}" target="_blank" class="mt-auto text-[10px] font-bold text-gold hover:text-black dark:hover:text-white uppercase tracking-widest transition-colors flex items-center gap-1">
                                ${translations[currentLang].readMore} <i class="fas fa-chevron-right text-[8px]"></i>
                            </a>
                        </div>
                    </article>
                `;
            }).join('');
        }

        // 3. Pencarian Interaktif (Live per Huruf)
        function liveSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const status = document.getElementById('searchStatus');
            const count = document.getElementById('countResults');
            const noRes = document.getElementById('noResults');

            const filtered = allPosts.filter(post => 
                post.title.rendered.toLowerCase().includes(query) || 
                post.excerpt.rendered.toLowerCase().includes(query)
            );

            if (query.length > 0) {
                status.classList.remove('hidden');
                count.innerText = filtered.length;
            } else {
                status.classList.add('hidden');
            }

            if (filtered.length === 0) {
                document.getElementById('blogGrid').innerHTML = '';
                noRes.classList.remove('hidden');
            } else {
                noRes.classList.add('hidden');
                renderPosts(filtered);
            }
        }

        // 4. Pengaturan Bahasa & Tema
        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            document.getElementById('langToggle').innerText = lang.toUpperCase();
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.innerHTML = translations[lang][key];
            });

            const input = document.getElementById('searchInput');
            input.placeholder = translations[lang].searchPlaceholder;
            
            if (allPosts.length > 0) renderPosts(allPosts); 
        }

        document.getElementById('langToggle').addEventListener('click', () => {
            setLanguage(currentLang === 'id' ? 'en' : 'id');
        });

        document.getElementById('themeToggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        });

        // Inisialisasi awal
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }
            setLanguage(currentLang);
            fetchAllPosts();
        });
    </script>
</body>
</html>
